#sql library
library(sqldf)

#clear env
rm(list = ls())

#read in csv's from working directory
dfp <- read.csv("ss16pia.csv")
dfh <- read.csv("ss16hia.csv")


#use to identify which columns you want available in the people file before the merge
#make sure to enter the columns names of the columns you want to use from the person file (dfp)
#already included serialno, wages, race, gender, occupation, private or public health coverage 
usecols <- c("SERIALNO", "WAGP", "PERNP", "PINCP", "OCCP", "RAC2P", "RAC3P", "PUBCOV", "PRIVCOV", "HICOV", "SEX")

#trim people data frame before merge
dfptrim <- dfp[ ,usecols]


#create merged file (matching up the people file to the house file by serialno)
dfmerge <- sqldf("SELECT * 
             FROM dfh
             LEFT JOIN dfptrim USING(SERIALNO)")


#convert serialno to factor for easier use
dfmerge$SERIALNO = as.factor(as.character(dfmerge$SERIALNO))

#optional, uncomment if you want to download the merged file into your working directory
#write.csv(dfmerge, "dfmerge.csv", row.names = FALSE)

